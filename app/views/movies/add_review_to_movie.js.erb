var $ = jQuery;

var title = '.modal-title',
    loader = '.ajax-loader',
    content = '.modal-body-content',
    dataRemote = 'a[data-remote=true], .btn[data-remote=true], .items_per_page_select .btn',
    modal = '#ajax-modal',
    dataToggle = 'a[data-toggle=modal]';

// hides the modal and shows the ajax content
$(loader).fadeToggle('fast', function () {
  $(content).hide().html('<%= j render('dialog_form') %>').show();

  var maxHeight = $(window).height() > 768 ? '600px' : '400px';

  $(modal).modal({
    width: '80%',
    maxHeight: maxHeight
  });

  $(loader).hide();
});

//brings the loader back up + gets rid of the content when linking to another controller method etc
$(content).on('click', dataToggle, function () {
  $(content).fadeOut('slow', function () {
    $(content).empty();
    $(loader).fadeIn('fast');
  });
});

$(content).on('click', dataRemote, function () {
  $(loader).fadeIn('fast');
});

$(content).on('click', '.pagination > ul > li > a', function () {
  $(loader).fadeIn('fast');
});